# HTTP入門  
例えば，Twitterのアカウントを表示するまでの流れを考える．  
- URLを解読する. 誰が??
- キャッシュにIPアドレスがあるかどうかを確認する．  
- DNSでIPアドレスを取得する．  
- IPアドレスでWebサーバにリクエストする．  
- ポート番号を割り当てる．  
- HTTPリクエストを送信する．  
- ロードバランサーでアクセスを調整する．  
- HTTPレスポンスを送信する．  
- レンダリングする．  

1. URL(Universal Resource Locator)  
    資源が唯一に特定されるためのアドレス．  

    https://twitter.com/unko_man  

    https://: プロトコル  
    twitter.con: ドメイン  
    unko_man: パス  

    このドメインとは，IPアドレス(ex.102.244.42.1)が人間にとってわかりくいため，わかりやすい名前をつけたもの．  

2. キャッシュにIPアドレスがあるかどうかを確認する．  
    ローカルにある一時的な保存領域のことをキャッシュと呼び，キャッシュにIPアドレスがあるかどうかを確認する．  
    IPアドレスとは，コンピュータ(サーバー)のインターネット上の住所のようなもの．  

3. なかったら，DNSでIPアドレスを取得する．   
    DNS(Domain Name System)とは，ドメイン名とIPアドレスを対応させるための仕組み．  

    そのドメイン名が指し示すIPアドレスをたくさん保持するのがDNSサーバー．  
    例えるならば，電話帳のようなもの(会社　→ 電話番号 ⇔　DNS　→ IPアドレス)．  

    twitter.com -> 104.244.42.1
    youtube.com -> 100.11.22.1  

    (IPがある場合は，そのIPアドレスにリクエストを送る．)

4. IPアドレスでWebサーバにリクエストする．  
    http, https通信では，それぞれ自動的に80, 443番ポートに接続する．  
    任意のポート番号に接続する場合は，URLに指定する．  
    104.244.42.1:3000 みたいな感じ．  

5. HTTPリクエストを送信する．  
    ユーザー(クライアント)がサーバーに対してHTTPリクエストを送信する．  

    HTTPリクエストは，以下のようなフォーマットになっている．

    |  HTTP リクエスト  
    | ---- 
    |  リクエストライン  
    |  ヘッダー 
    |  空行 
    |  メッセージボディ

    twitter.comにアクセスする場合のHTTPリクエストは以下のようになる．  
    ```
    > GET / HHTP/2              // リクエストライン
    > Host: twitter.com         // ヘッダー
    > user-agent: curl/7.78.0
    > accept: */*
    >                           // 空行
    ```

6. ロードバランサーでアクセスを調整する．
    負荷分散を目的に，比較的に負荷の少ないサーバーにアクセスを依頼する．  
    ```mermaid
    graph LR
        A[クライアント]　-->|リクエスト| B[ロードバランサー];
        B -->|リクエスト| C[サーバー1] & D[サーバー2] & E[サーバー3];
    ```

7. HTTPレスポンスを送信する．  
    HTTPレスポンスは，以下のようなフォーマットになっている．  
    ```
    > HHTP/2                    // ステータスライン
    > date: **                  // ヘッダー
    > expiry: **
    > ...
    >                           // 空行
    ```

    上に続くメッセージボディには，HTMLや画像などが含まれる．  

8. レンダリングする．  
    Loading: 最初に，HTMLを解釈し，CSSを適用する.   
    Scripting: JavaScriptを実行する．  
    Rendering: ページを描画する．  
    Painting: ページを描画する．  

