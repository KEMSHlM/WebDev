# OVERVIEW

[REST](https://qiita.com/NagaokaKenichi/items/0647c30ef596cedf4bf2), [ROAの学習記録](https://qiita.com/NagaokaKenichi/items/0f3a55e422d5cc9f1b9c)の学習記録．

**目次**

<!--toc:start-->

- [OVERVIEW](#overview)
- [リソース思考アーキテクチャ(ROA)](#リソース思考アーキテクチャroa)
  - [ソース思考アーキテクチャ(ROA)とは，何なのか？](#ソース思考アーキテクチャroaとは何なのか)
  - [ROAの4つの概念](#roaの4つの概念)
  - [ROAの4つの原則](#roaの4つの原則)
- [REST](#rest)
<!--toc:end-->

# リソース思考アーキテクチャ(ROA)

Web上に存在する情報，データのこと．コンピュータ上に格納することができ，一連のビットで表現できる．  
また，それ自体を参照するに値するほどの重要性を持つ．  
例えば，ドキュメント，データベースの行等．リソースは名詞で定義される．

1. ソフトウェアリリースのバージョン
2. 猫に関する情報
3. 天気予報

### ソース思考アーキテクチャ(ROA)とは，何なのか？

参照するに値するものを「リソース」として定義し，リソースを中心に考えるアーキテクチャのこと．
リソースという概念，リソースはURIを持つ，リソースに対する操作(統一インターフェース), リソースの表現形式(表現)を持つ．  
また，ROAはRESTful APIを実装する上で問題を解決してくれるアーキテクチャでもある．  
言い換えるとRESTful APIはROAの実装ということになる．

- ROAの4つの概念

1. リソース(リソースとは何か)
2. 名前（URl）
3. 表現（表現）
4. リソース間のリンク(リンクとの接続性)

- ROAの4つの原則

1. アドレス可読性
2. ステートレス性
3. 接続性
4. 統一インターフェース

以下で一つずつ解説していく．

### ROAの4つの概念

- URI
  **リソースは少なくとも１つのURlを持つ．**
  URlは，リソースの名前とアドレスが一致する必要がある． -

  - URlは記述的であるべき  
    URlとリソースは直感的に対応させた方が良い．さらに，**URlは構造的でかつ，その構造は予測可能な方法**で区別させる．  
    `/search/cat`のような構造であるとわかりやすい．

  - URlとリソースの関係  
    定義上，2つのリソースが同じであることはありえない．  
    それらが同じであるならば，リソースは一つしか存在しないはずである．ただし，なんらかの時点で２つの異なるリソースが同じデータをポイントすることがある．  
    例えば，以下の二つはしばしば同じファイルを指す.  
    `/software/release/1.0.3.zip`  
    `/software/release/latest.zip`

    だが，これら二つのURlの目的は異なってくる．  
    上は，常に特定のバージョンをポイントし，下の方はクライアントがアクセスした時点での最新のバージョンをポイントしている．  
    この場合，**これは二つの概念で，二つのリソースであるため問題ない．**

### ROAの4つの原則

- アドレス可能性  
  URlを通じてリソースを簡単に指し示せる性質のことを「アドレス可能性」と呼ぶ．  
  アプリケーションはアドレス可能となる．

- ステートレス性  
  全てのHTTPリクエストが完全に分離している性質のことを「ステートレス性」と呼ぶ．  
  サーバー側でアプリケーション状態の管理を行わない．  
  クライアントが送信するHTTPリクエストには，サーバがそのリクエストを処理するために必要な情報が全て含まれている．

- アプリケーション状態とリソース状態

  - アプリケーション状態  
    クライアント側で維持される状態のこと．  
    例えば, 何らかの検索エンジンを使用する際, 検索クエリや表示されている検索結果ページは人(クライアント)によって変わってくる.  
    これは検索エンジンでなくても、オークションサイトやショッピングサイト等でも同じことが言える。このように、クライアント側で維持される状態のことをアプリケーション状態と呼ぶ(サーバ側ではアプリケーション状態を維持しない).

  - リソース状態  
    サーバ側で維持される状態のこと.
    リソースは時間の経過や条件とともに変化する可能性がある. 例えば,「東京の明日の天気予報」というリソースは, 前日の10:00の時点では晴れの予報だが, 前日の18:00の時点では雨の予報に変わっている可能性がある. このように, サーバ側で維持される状態のことをリソース状態と呼ぶ. リソース状態は全てのクライアントに対して同じ状態が提供される.  
    ※ちなみに, RESTは「REpresentational State Transfer」というように, 状態を転送(レスポンスとして返却)する.

- 表現  
  Webサーバはリソースを特定の言語(日本語，英語)，フォーマット(XML, JSON)で送信する必要がある．  
  こういったリソースの形式をリソースの表現と呼ぶ．

- 表現の選択  
  サーバがリソースの表現を複数提供する場合，クライアントが要求している表をどの様にして判断するのか？という問題が発生してくる．  
  最も簡単な方法は，個別のURlを割り当てることである．

  `/resource.en`  
  `/resource.jp`

  といった様に個別のURlを割り当てる．これは推奨されるやり方ではあるが，別のリソースを指示している様に見える．
  そこで，コンテンツネゴシエーションを利用することで，

  `/resource`

  というURlで様々な言語やフォーマットのリソースを提供することが可能になる．

  - リソースは，表現が異なるだけでは区別しない．

- リンクと接続性  
  リソースには，別のリソースへのリンクを含めることができる．  
  このようにリソースに含まれるリンクを下に別のリソースに瀬雨族可能となる性質のことを「接続性」と呼ぶ．  
  従来のWebが使いやすいのは，リソースどうしが適切に接続されているからである．

?? 例えば，DiscordサーバでTodoアプリを作成した際に，タスクが完了した際にサーバーから通知するのは，RESTに反する？

- 統一インターフェース  
  詳細は，[HTTPメソッド](<./Memo.md##http\ method>).

- 安全性とべき等性  
  HTTPの統一インターフェースを設計通りにサポートすると，二つの有益な特性をただで手に入れることができる．

  - 安全性  
    GET, HEADリクストは，何らかのデータを読み取るためのリクエストであり，サーバの状態を変更するためのリクエストではない．このようなリクエストを「安全なリクエスト」と呼ぶ．

  - べき等性  
    その操作を何度も行っても結果が同じであることをいう概念を，べき等性と呼ぶ.  
    GET, HEAD, PUT, DELETEがその特性を持つ．

  安全性とべき等性により，クライアントは信頼できないネットワーク経由で，信頼できるHTTPリクエストを送信することができる．

# REST

REpresentational State Transfer の略で, Web サービスの設計原則の一つ.  
分散型システムにおける複数のソフトウェアを連携させるのに適した設計手法．

## RESTful APIを利用する上でのメリット

- URlに規律が生まれることで，APIを利用するサービス開発者が楽になる．
- URlに規律が生まれることで，API開発者もURlからソースのどの部分なのかが容易にわかる．
- ブラウザのアドレスバーにURlを入力すれば，リソースを参照することができる．
- サーバ，クライアント間で何も共有しないことにより，不可に応じたスケーラビリティが向上する．ステートレス性に値するもので，一番のメリットとされる．
- GET, POST, PUT, DELETE等のHTTP標準のメソッドを使うことで，シンプルで一貫性のあるリクエスト標準化が円滑に行える．統一インターフェースに値する．
